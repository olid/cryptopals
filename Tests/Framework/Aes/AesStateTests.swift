//
//  AesStateTests.swift
//  Tests
//
//  Created by olid on 27/07/2022.
//

import XCTest

final class AesStateTests: XCTestCase {
    func testAddRoundKey() throws {
        let state = AesState(byteArray: "Two One Nine Two".utf8Bytes)
        let roundkey = AesState(byteArray: "Thats my Kung Fu".utf8Bytes)
        
        let result = state.add(key: roundkey)
        
        XCTAssertEqual(result, AesState(byteArray: [0x00, 0x1f, 0x0e, 0x54, 0x3c, 0x4e, 0x08, 0x59, 0x6e, 0x22, 0x1b, 0x0b, 0x47, 0x74, 0x31, 0x1a]))
    }
    
    func testSubstitute() throws {
        let state = AesState(byteArray: [0x00, 0x1f, 0x0e, 0x54, 0x3c, 0x4e, 0x08, 0x59, 0x6e, 0x22, 0x1b, 0x0b, 0x47, 0x74, 0x31, 0x1a])
        let subsituted = state.substitute()
        
        XCTAssertEqual(subsituted, AesState(byteArray: [0x63, 0xc0, 0xab, 0x20, 0xeb, 0x2f, 0x30, 0xcb, 0x9f, 0x93, 0xaf, 0x2b, 0xa0, 0x92, 0xc7, 0xa2]))
    }
    
    func testShiftRows() throws {
        let state = AesState(byteArray: [0x63, 0xc0, 0xab, 0x20, 0xeb, 0x2f, 0x30, 0xcb, 0x9f, 0x93, 0xaf, 0x2b, 0xa0, 0x92, 0xc7, 0xa2])
        let shifted = state.shiftRows()
        
        XCTAssertEqual(shifted, AesState(byteArray: [0x63, 0x2f, 0xaf, 0xa2, 0xeb, 0x93, 0xc7, 0x20, 0x9f, 0x92, 0xab, 0xcb, 0xa0, 0xc0, 0x30, 0x2b]))
    }
    
    func testMixColumns() throws {
        let state = AesState(byteArray: [0x63, 0x2f, 0xaf, 0xa2, 0xeb, 0x93, 0xc7, 0x20, 0x9f, 0x92, 0xab, 0xcb, 0xa0, 0xc0, 0x30, 0x2b])
        let mixed = state.mixColumn()
        
        XCTAssertEqual(mixed, AesState(byteArray: [0xba, 0x75, 0xf4, 0x7a, 0x84, 0xa4, 0x8d, 0x32, 0xe8, 0x8d, 0x06, 0x0e, 0x1b, 0x40, 0x7d, 0x5d]))
    }
}



